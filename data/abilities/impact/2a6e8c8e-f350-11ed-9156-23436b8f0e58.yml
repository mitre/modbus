---

- id: 2a6e8c8e-f350-11ed-9156-23436b8f0e58
  name: Modbus Fuzz Registers
  description: |
    Procedure
    Modbus Function 6 (0x06) Write Single Register

    Writes random values to random registers over specified ranges. Addressing starts at 0 (e.g. registers 1-5 = addresses 0-4).
  tactic: impact
  technique:
    attack_id: T0831
    name: Manipulation of Control
  repeatable: True
  platforms:
    linux:
      sh:
        command:
          './modbus_cli #{modbus.server.ip} --port #{modbus.server.port} fuzz_r #{modbus.fuzz.holding.start} #{modbus.fuzz.holding.end} #{modbus.fuzz.holding.count} --min #{modbus.fuzz.holding.min} --max #{modbus.fuzz.holding.max} --wait #{modbus.fuzz.holding.wait}'
        payloads:
        - modbus_cli
    windows:
      psh:
        command:
         '.\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} fuzz_r #{modbus.fuzz.holding.start} #{modbus.fuzz.holding.end} #{modbus.fuzz.holding.count} --min #{modbus.fuzz.holding.min} --max #{modbus.fuzz.holding.max} --wait #{modbus.fuzz.holding.wait}'
        payloads:
        - modbus_cli.exe
